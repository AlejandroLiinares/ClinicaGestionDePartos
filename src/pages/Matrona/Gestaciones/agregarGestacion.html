<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Añadir Gestación - Matrona</title>

    <!-- CSS NORMALIZE-->
    <link rel="stylesheet" href="../../../styles/normalize.css" />

    <!-- CSS Global-->
    <link rel="stylesheet" href="../../../styles/global.css" />

    <!-- CSS Topbar -->
    <link rel="stylesheet" href="../../../styles/topbar.css" />

    <!-- CSS Menu de navegación -->
    <link rel="stylesheet" href="../../../styles/sidebar.css" />

    <!-- CSS Cards -->
    <link rel="stylesheet" href="../../../styles/cards.css" />

    <!-- CSS Form -->
    <link rel="stylesheet" href="../../../styles/form.css" />

    <!-- JS Tema -->
    <script src="../../../scripts/sub-themes.js" defer></script>

    <!-- JS DROPDOWN  -->
    <script src="../../../scripts/profile-dropdown.js" defer></script>

    <!-- SVG Favicon  -->
    <link rel="icon" type="image/svg+xml" href="/src/assets/svg/pregnant.svg">
</head>

<body>

<header class="top-header">
    
    <a href="../../../../index.html" class="nav__logo header-pill">
        <img src="../../../assets/icons/logo.png" alt="Logo" class="nav__logo-icon"
        width="90px" height="55px"/>
    </a>

    <div class="topbar-search header-pill">
        <img src="../../../assets/svg/buscar.svg" class="nav-svg" alt="Buscar"/>
        <input type="text" class="search-input" placeholder="Buscar en el sistema...">
    </div>

    <div class="actions-group header-pill">
        <button id="themeToggle" class="action-btn" aria-label="Cambiar tema">
            <img id="themeIcon" src="../../../assets/svg/moon.svg" alt="Tema" />
        </button>

        <button class="action-btn" aria-label="Correo TI">
            <img src="../../../assets/svg/correo.svg" alt="Correo TI" class="nav-svg"/>
        </button>

        <button class="action-btn" aria-label="Cerrar sesión">
            <img src="../../../assets/svg/salir.svg" alt="Cerrar sesión" class="nav-svg"/>
        </button>
    </div>

    <div class="profile-container header-pill">
        <img width="35" height="35" title="Foto de perfil"
        alt="Foto perfil" class="profile-photo"
        src="../../../assets/icons/matronaicon.png"/>

        <div class="profile-text">
            <span class="profile-name">Matrona Ana María</span>
            <span class="profile-email">ana.maria@clinica.cl</span>
        </div>

        <button class="dropdown-btn" aria-label="Más opciones">
            <img src="../../../assets/svg/flechaabajo.svg" alt="Más opciones" width="20px" height="20px"/>
        </button>

        <div class="profile-dropdown">
            <a href="../../Matrona/perfilMatrona.html">Ver mi perfil.</a>
        </div>
    </div>

</header>

<aside class="sidebar collapsed" id="sidebar">
    <nav class="nav-container">
        <a href="../inicioMatrona.html" class="nav-link active">
        <img src="../../../assets/svg/inicio.svg" class="nav-svg" />
            <span class="nav-text">Inicio</span>
        </a>

        <a href="../../Matrona/Pacientes/pacientes.html" class="nav-link">
            <img src="../../../assets/svg/paciente.svg" class="nav-svg" />
            <span class="nav-text">Pacientes</span>
        </a>

        <a href="../../Matrona/Gestaciones/gestaciones.html" class="nav-link">
            <img src="../../../assets/svg/gestacion.svg" class="nav-svg" />
            <span class="nav-text">Gestaciones</span>
        </a>

        <a href="../../Matrona/Partos/partos.html" class="nav-link">
            <img src="../../../assets/svg/parto.svg" class="nav-svg" />
            <span class="nav-text">Partos</span>
        </a>

        <a href="../../Matrona/RecienNacido/recienNacido.html" class="nav-link">
            <img src="../../../assets/svg/reciennacido.svg" class="nav-svg" />
            <span class="nav-text">Recién Nacidos</span>
        </a>

        <a href="../../Profesionales/profesionales.html" class="nav-link">
            <img src="../../../assets/svg/profesional.svg" class="nav-svg" />
            <span class="nav-text">Profesionales</span>
        </a>

        <a href="../../Turnos/turnos.html" class="nav-link">
            <img src="../../../assets/svg/turnos.svg" class="nav-svg" />
            <span class="nav-text">Turnos</span>
        </a>

        <a href="../../Usuarios/usuarios.html" class="nav-link">
            <img src="../../../assets/svg/usuarios.svg" class="nav-svg" />
            <span class="nav-text">Usuarios</span>
        </a>

        <a href="../../Supervisor/Reportes/reportes.html" class="nav-link">
            <img src="../../../assets/svg/reporte.svg" class="nav-svg" />
            <span class="nav-text">Reportes</span>
        </a>

        <a href="../../Supervisor/Auditoria/auditoria.html" class="nav-link">
            <img src="../../../assets/svg/auditoria.svg" class="nav-svg" />
            <span class="nav-text">Auditoría</span>
        </a>
    </nav>
</aside>

<main class="main-container">

    <!-- Breadcrumb -->
    <nav class="breadcrumbs">
        <a href="../inicioMatrona.html">Inicio</a>
        <span>›</span>
        <a href="gestaciones.html">Gestaciones</a>
        <span>›</span>
        <span>Nueva Gestación</span>
    </nav>

<section class="form-card">
    
    <div class="form-header">
        <h2 class="form-title">Nueva Gestación</h2>
        <p class="form-subtitle">Ingrese los datos para iniciar el control prenatal.</p>
    </div>

    <form method="POST" class="main-form">
        {% csrf_token %}

        <fieldset class="form-section">
            <legend class="section-legend">Vinculación y Estado</legend>

            <div class="form-row">
                <div class="form-group">
                    <label for="paciente">Paciente</label>
                    <select id="paciente" name="paciente" required>
                        <option value="" disabled selected>Buscar paciente...</option>
                        {% for paciente in form.fields.paciente.queryset %}
                            <option value="{{ paciente.id }}">
                                {{ paciente.obtener_nombre_completo }} ({{ paciente.identificacion }})
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label for="estado">Estado de la Gestación</label>
                    <select id="estado" name="estado" required>
                        {% for value, label in form.fields.estado.choices %}
                            <option value="{{ value }}" {% if value == 'curso' %}selected{% endif %}>
                                {{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="riesgo">Clasificación de Riesgo</label>
                    <select id="riesgo" name="riesgo">
                        {% for value, label in form.fields.riesgo.choices %}
                            <option value="{{ value }}">{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label for="numero_fetos">Número de Fetos</label>
                    <input type="number" id="numero_fetos" name="numero_fetos" 
                           min="1" max="5" value="{{ form.numero_fetos.value|default:'1' }}" required>
                </div>
            </div>
        </fieldset>

        <fieldset class="form-section">
            <legend class="section-legend">Datación y Edad Gestacional</legend>

            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label for="origen_datacion">Origen de Datación</label>
                <select id="origen_datacion" name="origen_datacion" required>
                    <option value="" disabled selected>Seleccione método (FUR o ECO)</option>
                    {% for value, label in form.fields.origen_datacion.choices %}
                        <option value="{{ value }}">{{ label }}</option>
                    {% endfor %}
                </select>
                <span class="field-help">Seleccione el método principal para calcular la ED. Gestacional.</span>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="fur">Fecha Última Regla (FUR)</label>
                    <input type="date" id="fur" name="fur" 
                           value="{{ form.fur.value|date:'Y-m-d' }}">
                </div>
                <div class="form-group"></div> 
            </div>

            <div class="form-row three-cols">
                <div class="form-group">
                    <label for="fecha_eco">Fecha de la Ecografía</label>
                    <input type="date" id="fecha_eco" name="fecha_eco" 
                           value="{{ form.fecha_eco.value|date:'Y-m-d' }}">
                </div>

                <div class="form-group">
                    <label for="semanas_eco">Semanas (según Eco)</label>
                    <input type="number" id="semanas_eco" name="semanas_eco" 
                           placeholder="Ej: 12" min="0" max="42"
                           value="{{ form.semanas_eco.value|default:'' }}">
                </div>

                <div class="form-group">
                    <label for="dias_eco">Días (según Eco)</label>
                    <input type="number" id="dias_eco" name="dias_eco" 
                           placeholder="Ej: 4" min="0" max="6"
                           value="{{ form.dias_eco.value|default:'' }}">
                </div>
            </div>
        </fieldset>

        <fieldset class="form-section">
            <legend class="section-legend">Factores de Riesgo y Antecedentes</legend>

            <div class="checkbox-grid">
                <label class="checkbox-card">
                    <input type="checkbox" name="hipertension" id="hipertension" 
                           {% if form.hipertension.value %}checked{% endif %}>
                    <span class="checkbox-text">Hipertensión</span>
                </label>

                <label class="checkbox-card">
                    <input type="checkbox" name="diabetes" id="diabetes"
                           {% if form.diabetes.value %}checked{% endif %}>
                    <span class="checkbox-text">Diabetes</span>
                </label>

                <label class="checkbox-card">
                    <input type="checkbox" name="enfermedad_cardiaca" id="enfermedad_cardiaca"
                           {% if form.enfermedad_cardiaca.value %}checked{% endif %}>
                    <span class="checkbox-text">Enfermedad Cardíaca</span>
                </label>

                <label class="checkbox-card">
                    <input type="checkbox" name="multiple" id="multiple"
                           {% if form.multiple.value %}checked{% endif %}>
                    <span class="checkbox-text">Embarazo Múltiple</span>
                </label>
            </div>
        </fieldset>

        <div class="form-actions">
            <button type="button" class="btn-secondary" onclick="history.back()">Cancelar</button>
            <button type="submit" class="btn-primary">Registrar Gestación</button>
        </div>

    </form>
</section>
</main>

</body>
</html>
